# U-Boot Build Guide for Genesys2

## Important Files

### 1. u-boot/configs/genesys2_defconfig

- Default configuration file for building U-Boot for Genesys2 board
- Specifies the device tree (DTS) file via the `CONFIG_DEFAULT_DEVICE_TREE` parameter
- You can create custom config files in this directory for different hardware configurations

### 2. u-boot/genesys2/setup_genesys2.sh

- Build script for generating the U-Boot binary for a specified DTS file
- Copies the built binary to `../../build/<dts_name>/u-boot.bin`

## Build Instructions

### Prerequisites
- RISC-V cross-compiler (`riscv64-linux-gnu-gcc`)
- Device tree source file (`.dts`) placed in `u-boot/arch/riscv/dts/`
- Compiled device tree binary (`.dtb`) generated during build

### Steps to Build U-Boot

1. **Place your device tree file**
   ```bash
   cp your_design.dts u-boot/arch/riscv/dts/
   ```

   - You cant add the .dts file which is generated by the chipyard as it is. You need to do some changes(memory etc.). Please refer to the given example for more information regarding that.

2. **Update the configuration file**
   - Edit `u-boot/configs/genesys2_defconfig` (or your custom config file)
   - Modify the `CONFIG_DEFAULT_DEVICE_TREE` line to match your DTS filename (without `.dts` extension)
   ```
   CONFIG_DEFAULT_DEVICE_TREE="your_design_name"
   ```

3. **Customize the build script (optional)**
   - If using a non-default config, edit `setup_genesys2.sh`
   - Change the `CONFIG_FILE` variable at the top of the script
   ```bash
   CONFIG_FILE="your_custom_defconfig"
   ```

4. **Run the build script**
   ```bash
   cd u-boot/genesys2
   ./setup_genesys2.sh
   ```

5. **Verify the build**
   - Look for success messages:
     - "U-Boot successfully built"
     - "Build process completed successfully"
   - Binary location: `../../build/<dts_name>/u-boot.bin`

### Next Steps
After successful U-Boot build, proceed with OpenSBI build which uses the generated U-Boot binary as a payload.